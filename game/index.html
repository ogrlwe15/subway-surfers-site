<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Subway Surfers</title>

    <script type="text/javascript" src="4399.z.js"></script>
    <script>
        window.config = {
            loader: 'unity',
            debug: false,
            maxRatio: 16 / 9,
            minRatio: 9 / 16,

            title: 'Subway Surfers: San Francisco',

            unityVersion: '2019.4.18f1',
            unityWebglBuildUrl: 'Build\/SanFrancisco\/SanFrancisco.json',

            fileSize: 35,
            cachedDecompressedFileSizes: {
                'SanFrancisco.asm.code.unityweb': 9077143,
                'SanFrancisco.asm.framework.unityweb': 86369,
                'SanFrancisco.asm.memory.unityweb': 951447,
                'SanFrancisco.data.unityweb': 18323917,
                'SanFrancisco.wasm.code.unityweb': 7279617,
                'SanFrancisco.wasm.framework.unityweb': 90693,
            },
        };

        // === SCRIPT DE D√âBLOCAGE ===
        window.addEventListener('load', function() {
            console.log('üîì Initialisation du syst√®me de d√©blocage...');
            
            // Attendre que le jeu soit charg√©
            setTimeout(function() {
                unlockAllCharacters();
            }, 5000);
        });

        function unlockAllCharacters() {
            console.log('üéÆ Tentative de d√©blocage des personnages...');
            
            // M√©thode 1: Intercepter le localStorage
            const originalSetItem = localStorage.setItem;
            localStorage.setItem = function(key, value) {
                console.log('üìù Sauvegarde d√©tect√©e:', key);
                
                if (key.includes('unity') || key.includes('save') || key.includes('game')) {
                    try {
                        let saveData = JSON.parse(value);
                        console.log('üíæ Donn√©es de sauvegarde originales:', saveData);
                        
                        // Modifier les donn√©es pour d√©bloquer tout
                        let modifiedSave = modifySaveData(saveData);
                        console.log('‚ú® Donn√©es modifi√©es:', modifiedSave);
                        
                        return originalSetItem.call(this, key, JSON.stringify(modifiedSave));
                    } catch(e) {
                        console.log('‚ùå Impossible de parser JSON, sauvegarde brute');
                    }
                }
                return originalSetItem.apply(this, arguments);
            };

            // M√©thode 2: Forcer le d√©blocage via l'objet jeu
            setTimeout(() => {
                if (window.Module && window.Module.unityGame) {
                    console.log('üéØ Module Unity d√©tect√©');
                    forceUnlockThroughUnity();
                }
            }, 3000);

            // M√©thode 3: Modifier les sauvegardes existantes
            modifyExistingSaves();
        }

        function modifySaveData(saveData) {
            // Essayer diff√©rents formats de sauvegarde Unity
            if (typeof saveData === 'object') {
                // Format 1: Donn√©es directes
                if (saveData.characters) {
                    saveData.characters.forEach(char => {
                        char.unlocked = true;
                        char.purchased = true;
                    });
                }
                
                // Format 2: Progress data
                if (saveData.playerProgress) {
                    saveData.playerProgress.allCharactersUnlocked = true;
                    saveData.playerProgress.coins = 999999;
                    saveData.playerProgress.keys = 999;
                }
                
                // Format 3: Simple flags
                saveData.allUnlocked = true;
                saveData.unlockedAll = true;
                saveData.coins = 999999;
                saveData.totalCoins = 999999;
                saveData.keys = 999;
                
                // Format 4: Array de personnages d√©bloqu√©s
                saveData.unlockedCharacters = ['all'];
                saveData.purchasedItems = ['all'];
            }
            
            return saveData;
        }

        function modifyExistingSaves() {
            // Modifier toutes les sauvegardes existantes
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.includes('unity') || key.includes('save') || key.includes('game') || key.includes('progress')) {
                    try {
                        const value = localStorage.getItem(key);
                        const saveData = JSON.parse(value);
                        const modifiedSave = modifySaveData(saveData);
                        localStorage.setItem(key, JSON.stringify(modifiedSave));
                        console.log('‚úÖ Sauvegarde modifi√©e:', key);
                    } catch(e) {
                        // Ignorer les erreurs de parsing
                    }
                }
            }
        }

        function forceUnlockThroughUnity() {
            // Essayer d'acc√©der √† l'instance Unity
            if (window.Module && window.Module.SendMessage) {
                // Envoyer des commandes au jeu
                try {
                    // Commandes courantes pour d√©bloquer
                    const commands = [
                        'UnlockAll',
                        'UnlockAllCharacters', 
                        'AddCoins:999999',
                        'AddKeys:999',
                        'CompleteAllMissions'
                    ];
                    
                    commands.forEach(cmd => {
                        try {
                            window.Module.SendMessage('GameManager', cmd, '');
                            console.log('üì® Commande envoy√©e:', cmd);
                        } catch(e) {}
                    });
                } catch(e) {
                    console.log('‚ùå Impossible d\'envoyer des commandes Unity');
                }
            }
        }

        // Fonction accessible depuis l'ext√©rieur
        window.unlockAllCharactersManual = function() {
            unlockAllCharacters();
            alert('üéâ D√©blocage manuel activ√©! Recharge la page.');
        };

        console.log('üîì Syst√®me de d√©blocage charg√© - Utilise unlockAllCharactersManual() dans la console');
        
    </script>
</head>

<body>
    <script src="master-loader.js"></script>
    
    <!-- Bouton de d√©blocage manuel -->
    <div style="position: fixed; top: 10px; left: 10px; z-index: 10000;">
        <button onclick="unlockAllCharactersManual()" style="
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: black;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.5);
            font-size: 14px;
        ">üîì D√âBLOQUER TOUT</button>
    </div>
</body>
</html>
